
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Futsal League Sydney</title>
  <style>
    /* Padronizar largura dos campos League, Date e Round no Match Results */
    #match-results input[type="text"],
    #match-results input[type="date"],
    #match-results select {
      width: 220px;
      min-width: 0;
      box-sizing: border-box;
      display: block;
    }
    /* Evitar sobreposição dentro do card de Match Results */
    #match-results {
      --vs-width: 22px;
    }

    #match-results .teams-row,
    #match-results .goals-row{
      grid-template-columns: minmax(0,1fr) var(--vs-width) minmax(0,1fr);
      column-gap: 8px;
    }

    #match-results .teams-row select,
    #match-results .goals-row input[type="number"]{
      width: 100%;
      min-width: 0;
      box-sizing: border-box;
    }

    @media (max-width: 540px){
      #match-results .teams-row,
      #match-results .goals-row{
        grid-template-columns: 1fr;
      }
      #match-results .vs,
      #match-results .spacer{ display:none; }
    }
    /* === Deixar a aba Match Results com o mesmo tamanho da Player Performance === */
    #match-results .container{
      max-width: 1200px;
      margin-left: 0;
      margin-right: auto;
      padding: 0 16px;
    }

    #match-results .two-col{
      grid-template-columns: 400px 1fr;
      gap: 24px;
    }

    #match-results .card:first-child{
      max-width: 400px;
    }

    @media (max-width: 900px){
      #match-results .two-col{ grid-template-columns: 1fr; gap: 12px; }
    }
    /* Fundo: degradê azul → preto cobrindo a tela toda */
      /* Centralizar inputs type="number" e remover spinners/setas */
      #player-performance input[type="number"],
      .goals-row input[type="number"] {
        text-align: center;
        width: 72px;
        padding: 6px 8px;
        box-sizing: border-box;
        font-variant-numeric: tabular-nums;
      }

      /* remover setas (Chrome/Edge/Safari) */
      #player-performance input[type="number"]::-webkit-outer-spin-button,
      #player-performance input[type="number"]::-webkit-inner-spin-button,
      .goals-row input[type="number"]::-webkit-outer-spin-button,
      .goals-row input[type="number"]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      /* remover setas (Firefox) */
      #player-performance input[type="number"],
      .goals-row input[type="number"] {
        -moz-appearance: textfield;
      }
    html, body { height: 100%; }
    body {
      margin:0;
      font-family: Arial, sans-serif;
      color:#222;
      background: linear-gradient(180deg, #0a2a6c 0%, #000 100%);
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: 100% 100%;
      min-height: 100vh;
    }

    header { background:#222; color:#fff; padding:1.8rem; text-align:center; font-weight:700; font-size:22px; }
    .tabs {
  display: flex;
  justify-content: center;
  gap: 24px;
  padding: 16px 0 10px 0; /* menos espaço acima e abaixo */
}

.tab {
  color: #fff;
  background: transparent;
  font-weight: 600;
  font-size: 1.15rem;
  border-radius: 16px;
  padding: 0.7rem 2.2rem;
  box-shadow: none;
  border: none;
  transition: background 0.2s, box-shadow 0.2s;
  display: flex;
  align-items: center;
}

.tab.active {
  background: linear-gradient(90deg, #5b8cff 0%, #8f5bff 100%);
  color: #fff;
  box-shadow: 0 4px 16px rgba(80,80,160,0.13);
  border: none;
}

    .container {
  max-width: 1400px;
  margin: 1rem auto; /* reduz o espaço acima do conteúdo */
  padding: 0 16px;
}
    .two-col { display:grid; grid-template-columns: 1fr 2.5fr; gap:24px; }
    .card { background:#fff; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,.08); padding:1.25rem; }

    /* --- estilos originais do form --- */
    form { display:flex; flex-direction:column; }
    label { margin-top:10px; font-weight:600; }      /* labels padrão à ESQUERDA */
    input, select { padding:.55rem; margin-top:6px; border:1px solid #ccc; border-radius:4px; }
    button { margin-top:16px; padding:.8rem; border:0; border-radius:6px; background:#0d6efd; color:#fff; font-size:1rem; cursor:pointer; }
    button:hover { background:#0b5ed7; }
    .success-message { color:green; display:none; margin-top:12px; }

    .muted { color:#666; font-size:13px; margin:.25rem 0 .75rem; }

    .table-wrap { overflow:auto; border:1px solid #eee; border-radius:6px; }
    table { width:100%; border-collapse:collapse; font-size:14px; table-layout:auto; }
    th, td { border-bottom:1px solid #eee; padding:.55rem .6rem; text-align:left; white-space:nowrap; }
    th { background:#f5f5f5; position:sticky; top:0; z-index:1; }
    td.num { text-align:center; }

    button.btn-del {
      padding:.35rem .6rem;
      font-size:.85rem;
      border:0; border-radius:4px;
      background:#dc3545; color:#fff; cursor:pointer;
    }
    button.btn-del:hover { background:#bb2d3b; }

    /* --- SOMENTE as 4 colunas centralizadas --- */

    /* Largura fixa compartilhada entre "vs" e o espaçador, garantindo alinhamento entre linhas */
    :root { --vs-width: 2.4ch; }   /* 2 letras + folga */

    /* Linha dos TIMES: 1fr | vs | 1fr, labels centralizados apenas aqui */
    .teams-row {
      display: grid;
      grid-template-columns: 1fr var(--vs-width) 1fr;
      column-gap: 12px;
      align-items: end;          /* alinha pelos inputs */
      margin-top: 20px;
      margin-bottom: 20px;
    }
    .teams-row label { text-align:center; }  /* centraliza só Home/Away Team */

    /* O “vs” não altera alturas e fica discreto */
    .vs {
      display:flex;
      align-items:center;
      justify-content:center;
      width: var(--vs-width);
      font-weight:700;
      font-size:16px;
      color:#444;
      user-select:none;
      pointer-events:none;
    }

    /* Linha dos GOLS: mesma grade (1fr | espaço | 1fr) */
    .goals-row {
      display: grid;
      grid-template-columns: 1fr var(--vs-width) 1fr;
      column-gap: 12px;
      align-items: end;
      margin-top: 6px;
      margin-bottom: 20px;
    }
    .goals-row label {
      text-align: center;
      width: 100%;
      display: block;
    }  /* centraliza só Home/Away Goals */
    .spacer { width: var(--vs-width); }      /* ocupa o mesmo “slot” do vs */
    .goals-row input[type="number"] {
      text-align: center;
    }

      /* ===== Caixa CINZA para Teams + Goals ===== */
      #match-results .teams-goals-box{
        background: #f2f2f2;        /* cinza do bloco */
        border-radius: 14px;
        padding: 16px 18px;         /* respiro interno */
        margin: 16px 0 20px;        /* espaço antes/depois da caixa */
        box-shadow: 0 1px 4px rgba(0,0,0,.06);
      }

      /* Espaçamento entre a linha de times e a linha de gols dentro da caixa */
      #match-results .teams-goals-box .teams-row{
        margin-top: 0;
        margin-bottom: 16px;        /* distância para a linha de gols */
      }
      #match-results .teams-goals-box .goals-row{
        margin-top: 0;
        margin-bottom: 0;
      }

      /* Garantir títulos centralizados dentro da caixa (Home/Away Team & Goals) */
      #match-results .teams-goals-box .teams-row label,
      #match-results .teams-goals-box .goals-row .perf-field > label{
        text-align: center;
        width: 100%;
        display: block;
      }

      /* (opcional) mobile */
      @media (max-width: 600px){
        #match-results .teams-goals-box{
          padding: 14px;
          border-radius: 12px;
        }
      }

    .teams-row select,
.goals-row input[type="number"] {
  width: 220px; /* ajuste conforme desejar */
  min-width: 0;
  box-sizing: border-box;
}

    @media (max-width: 1000px){
      .two-col { grid-template-columns: 1fr; }
    }
    @media (max-width: 600px){
      /* Em telas pequenas, empilha as duas colunas */
      .teams-row, .goals-row { grid-template-columns: 1fr; }
      .vs, .spacer { display:none; }
      .teams-row label, .goals-row label { text-align:center; } /* volta ao padrão no mobile */
    }

    /* Deixe todos os inputs do formulário com a mesma largura */
    form label input[type="text"],
    form label input[type="date"] {
      width: 180px; /* ajuste conforme desejar */
      min-width: 0;
      display: block;
      margin-left: 0;
    }

    #powerbi-dashboard .powerbi-card {
  padding: 0;
  border-radius: 0;
  box-shadow: none;
  background: #fff;
  height: 80vh;
  min-height: 500px;
  display: flex;
}
#powerbi-dashboard iframe {
  width: 100%;
  height: 100%;
  border: none;
  border-radius: 0;
  display: block;
}

.player-performance-card {
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.08);
  padding: 1.25rem;
  margin-top: 1rem;
}

.form-row {
  display: flex;
  gap: 12px;
  margin-bottom: 1rem;
}

.form-row:first-child {
  flex-direction: row;
}

.form-row:not(:first-child) {
  flex-direction: row;
}

.form-row label {
  flex: 1;
}

.performance-groups {
  display: grid;
  grid-template-columns: 1fr;
  gap: 14px;
  margin-bottom: 2.0rem;
}

.perf-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  align-items: center;
  margin-bottom: 24px;
}


.perf-group {
  gap: 0;
  background: #f9f9f9;
  padding: 1rem;
  border-radius: 6px;
  min-width: 0;
  display: flex;
  flex-direction: column;
  height: 100%;
}

.perf-field {
  margin-bottom: 1rem;
}

.input-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.btn-minus, .btn-plus {
  background: #007bff;
  color: #fff;
  border: none;
  border-radius: 4px;
  padding: 0.4rem 0.8rem;
  cursor: pointer;
}

.btn-minus:hover, .btn-plus:hover {
  background: #0056b3;
}

.submit-btn {
  background: #28a745;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 0.8rem;
  font-size: 1rem;
  cursor: pointer;
}

.submit-btn:hover {
  background: #218838;
}

/* Padronize largura dos selects na aba Player Performance */
#player-performance select {
  width: 220px;
  min-width: 0;
  box-sizing: border-box;
  display: block;
  margin-left: 0;
}
#player-performance .form-row {
  display: flex;
  gap: 12px;
  margin-bottom: 1rem;
}
#player-performance .form-row label {
  flex: 1;
  display: flex;
  flex-direction: column;
  font-weight: 600;
}

/* Reduza a largura máxima do container da aba Player Performance */
#player-performance .container {
  max-width: 1200px; /* ou maior, conforme desejar */
  margin-left: 0;
  margin-right: auto;
  padding: 0 16px;
}

/* Aumente a largura da coluna do formulário e do card */
#player-performance .two-col {
  grid-template-columns: 400px 1fr; /* aumente para 400px ou mais */
  gap: 24px;
}
#player-performance .card:first-child {
  max-width: 400px;
}

/* Reduza a largura dos selects e inputs */
#player-performance select,
#player-performance input[type="number"],
#player-performance input[type="url"] {
  width: 100%;
  min-width: 0;
  box-sizing: border-box;
  font-size: 0.95rem;
  padding: 0.45rem;
}

/* Reduza a largura dos botões de + e - */
#player-performance .btn-minus,
#player-performance .btn-plus {
  padding: 0.3rem 0.6rem;
  font-size: 0.95rem;
}

/* Ajuste os grupos para empilhar em telas menores */
@media (max-width: 900px) {
  #player-performance .performance-groups {
    grid-template-columns: 1fr;
    gap: 12px;
  }
}

#player-performance input[type="number"] {
  text-align: center;
}

#player-performance .perf-group h3 {
  font-size: 1.05rem;
  font-weight: 700;
  margin-bottom: 0.8rem;
}

.card-options {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}
.card-radio {
  display: flex;
  align-items: center;
  background: #f9f9f9;
  border-radius: 8px;
  padding: 6px 10px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.07);
  cursor: pointer;
  transition: box-shadow 0.2s;
}
.card-radio input[type="radio"] {
  margin-right: 5px;
  accent-color: #222;
  width: 14px;
  height: 14px;
}
.card-radio.yellow {
  background: #ffe066;
}
.card-radio.red {
  background: #ff4d4f;
}
.card-radio .card-label {
  font-size: 0.62rem;
  font-weight: 400;
  color: #222;
  padding-top: 1px;
}
.card-radio.red .card-label {
  color: #fff;
}

.card-visual-options {
  display: flex;
  gap: 10px;
  margin-top: 10px;
  justify-content: flex-start;
  align-items: center;
}
.card-select-wrap {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 8px;
}
.card-select-wrap input[type="radio"] {
  width: 18px;
  height: 18px;
  accent-color: #222;
  margin-right: 0;
  margin-left: 0;
}
.card-visual {
  width: 24px;
  height: 36px;
  border-radius: 8px;
  display: inline-block;
  box-shadow: 0 2px 8px rgba(0,0,0,0.10);
  cursor: pointer;
  transition: box-shadow 0.2s, transform 0.2s;
  background: #fff;
}
.card-visual.yellow {
  background: #ffe100;
}
.card-visual.red {
  background: #ff2d2d;
}
.card-select-wrap input[type="radio"]:focus + .card-visual {
  outline: 2px solid #222;
}
.card-visual:hover {
  box-shadow: 0 4px 16px rgba(0,0,0,0.18);
  transform: scale(1.05);
}

.card-yellow, .card-red {
  width: 12px;   /* diminua conforme necessário */
  height: 12px;
  border-radius: 6px;
  display: inline-block;
}

.card-yellow {
  width: 6px;
  height: 6px;
  background: yellow;
}

.card-red {
  width: 6px;
  height: 6px;
  background: red;
}

input[type="radio"] {
  width: 14px;   /* diminua conforme necessário */
  height: 14px;
  accent-color: inherit; /* mantém cor padrão, se quiser */
  transform: scale(0.6); /* alternativa para reduzir */
}

.cards-container {
  display: flex;
  align-items: center;
  gap: 4px; /* diminua para aproximar */
}

.card-yellow, .card-red {
  margin: 0 3px; /* diminua ou remova */
}
/* ===== Alinhar perfeitamente:  - 0 +  ===== */
#player-performance .input-group {
  display: flex;
  align-items: center;   /* centraliza verticalmente */
  gap: 8px;
}

/* altura única para tudo */
:root { --ctrl-h: 26px;  --ig-gap: 10px; }   /* ajuste fino aqui: 34–40px */


/* linha com esquerda/direita */
.perf-row{
  gap: 0px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  column-gap: var(--col-gap, 24px);
  row-gap: var(--row-gap, 16px);
  align-items: center;
}

  /* diminuir o espaço ENTRE as duas colunas (esq x dir) */
  #player-performance .perf-row {
    --col-gap: 12px;       /* antes era 24px */
  }

  /* (opcional) diminuir o espaço ENTRE AS LINHAS (Goals↔Shots↔Passes) */
  #player-performance .performance-groups .perf-row {
    --row-gap: 10px;       /* antes era 16px */
  }

  /* (opcional) reduzir o espaço vertical dentro de cada bloco */
  #player-performance .perf-field {
    margin-bottom: 0.6rem; /* antes 1rem */
  }

/* grupo -, 0, +  */
#player-performance .input-group{
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: var(--ig-gap, 10px);
}

#player-performance .input-group input[type="number"]{
  height: var(--ctrl-h, 26px);
  line-height: var(--ctrl-h, 26px);
  padding: 0 12px;
  box-sizing: border-box;
  text-align: center;
}

#player-performance .input-group .btn-minus,
#player-performance .input-group .btn-plus{
  width: var(--ctrl-h, 26px);
  height: var(--ctrl-h, 26px);
  padding: 0;
  display: flex; align-items: center; justify-content: center;
  box-sizing: border-box;
}

/* mantenha o margin-top apenas no botão de submit */
.submit-btn { margin-top: 16px; }
  /* ==== overrides finais para reduzir espaços na Player Performance ==== */
  #player-performance .perf-row{
    column-gap: 12px !important;   /* espaço entre as duas colunas (esq x dir) */
    row-gap: 8px !important;       /* espaço interno da grid entre linhas */
    margin-bottom: 0 !important;   /* zera o espaçamento herdado de 24px */
  }

  #player-performance .perf-field{
    margin: 6px 0 !important;      /* reduz o respiro dentro de cada campo */
  }

  /* se quiser ainda mais compactado, pode reduzir a margem das .form-row também */
  #player-performance .form-row{
    margin-bottom: 8px !important;
  }
  </style>
</head>
<body>
  <header>
  <img src="https://raw.githubusercontent.com/futsal-league-performance/league-performance/refs/heads/main/Futsal%20Sydney%20Logo.png" alt="Futsal Sydney Logo" style="height:54px; vertical-align:middle; margin-right:18px;">
  Futsal League Sydney
</header>

  <div class="tabs">
    <div class="tab active" onclick="switchTab('match-results', event)">Match Results</div>
    <div class="tab" onclick="switchTab('player-performance', event)">Player Performance</div>
    <div class="tab" onclick="switchTab('powerbi-dashboard', event)">Dashboard</div>
  </div>

  <!-- MATCH RESULTS -->
  <div id="match-results" class="container form-section" style="display:block;">
    <div class="two-col">
      <!-- Formulário -->
      <div class="card">
        <h2>Match Results</h2>
        <form onsubmit="return submitForm(event, 'match-results')">
          <label>League <input type="text" name="League" placeholder="Heffron"/></label>
          <label>Date <input type="date" id="date" name="Date" required/></label>
          <label>Round</label>
          <select name="Round" required>
            <option value="">Selecione</option>
            <option>R1</option>
            <option>R2</option>
            <option>R3</option>
            <option>R4</option>
            <option>R5</option>
            <option>R6</option>
            <option>R7</option>
            <option>R8</option>
            <option>R9</option>
            <option>R10</option>
            <option>R11</option>
            <option>R12</option>
            <option>R13</option>
            <option>R14</option>
          </select>

          <!-- Bloco cinza para Teams + Goals -->
          <div class="teams-goals-box">
            <div class="teams-row">
              <label>Home Team
                <select id="homeTeam" name="Home Team" required>
                  <option>Kairat Sydney FC</option>
                  <option>Sporting Sydney FC</option>
                  <option>Auburn City FC</option>
                  <option>NM Futsal</option>
                  <option>East Coast Bulls FC</option>
                  <option>Myagdi FC</option>
                  <option>Mosaic Metros FC</option>
                  <option>Roselea FC</option>
                  <option>United FC</option>
                  <option>Indoor5's FC</option>
                  <option>North Sydney FC</option>
                  <option>SSC FC</option>
                  <option>Kairat FC</option>
                </select>
              </label>
              <div class="vs">vs</div>
              <label>Away Team
                <select name="Away Team" required>
                  <option>Kairat Sydney FC</option>
                  <option>Sporting Sydney FC</option>
                  <option>Auburn City FC</option>
                  <option>NM Futsal</option>
                  <option>East Coast Bulls FC</option>
                  <option>Myagdi FC</option>
                  <option>Mosaic Metros FC</option>
                  <option>Roselea FC</option>
                  <option>United FC</option>
                  <option>Indoor5's FC</option>
                  <option>North Sydney FC</option>
                  <option>SSC FC</option>
                  <option>Kairat FC</option>
                </select>
              </label>
            </div>

            <div class="goals-row">
              <div class="perf-field">
                <label>Home Goals</label>
                <div class="input-group">
                  <button type="button" class="btn-minus" onclick="changeValue(this, -1)">−</button>
                  <input type="number" name="Home Goals" value="0" min="0"/>
                  <button type="button" class="btn-plus" onclick="changeValue(this, 1)">+</button>
                </div>
              </div>

              <div class="spacer"></div>

              <div class="perf-field">
                <label>Away Goals</label>
                <div class="input-group">
                  <button type="button" class="btn-minus" onclick="changeValue(this, -1)">−</button>
                  <input type="number" name="Away Goals" value="0" min="0"/>
                  <button type="button" class="btn-plus" onclick="changeValue(this, 1)">+</button>
                </div>
              </div>
            </div>
          </div>

          <button type="submit">Submit Match</button>
          <div class="success-message">Match data submitted successfully!</div>
        </form>
      </div>

      <!-- Tabela -->
      <div class="card">
        <h2 style="margin-bottom:.6rem;">Existing Matches</h2>
        <div class="muted">
          Source: match-results 
          (<a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vS6YT_gPXXtEOScZDDZsDwsukVh3bEoaZ-pLK-jVlkURcymI0WzrnJQulVij4FhA5LXdGtsT1c26PVO/pubhtml?gid=196825572&single=true" target="_blank" rel="noopener">Show data</a>)
        </div>
        <div class="table-wrap" id="matches-table">
          <table>
            <thead id="matches-thead"></thead>
            <tbody id="matches-tbody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- PLAYER PERFORMANCE -->
  <div id="player-performance" class="container form-section" style="display:none;">
    <div class="two-col">
      <!-- Coluna da ESQUERDA: Formulário -->
      <div class="card">
        <h2>Player Performance</h2>
        <form onsubmit="return submitForm(event, 'player-performance')">
          <div class="form-row">
            <label>Round
              <select name="Round" required>
                <option value="">Selecione</option>
                <option>R1</option>
                <option>R2</option>
                <option>R3</option>
                <option>R4</option>
                <option>R5</option>
                <option>R6</option>
                <option>R7</option>
                <option>R8</option>
                <option>R9</option>
                <option>R10</option>
                <option>R11</option>
                <option>R12</option>
                <option>R13</option>
                <option>R14</option>
              </select>
            </label>
          </div>
          <div class="form-row">
            <label>Team
              <select name="Team" required>
                <option value="">Selecione</option>
                <option>Kairat Sydney FC</option>
                <option>Sporting Sydney FC</option>
                <option>Auburn City FC</option>
                <option>NM Futsal</option>
                <option>East Coast Bulls FC</option>
                <option>Myagdi FC</option>
                <option>Mosaic Metros FC</option>
                <option>Roselea FC</option>
                <option>United FC</option>
                <option>Indoor5's FC</option>
                <option>North Sydney FC</option>
                <option>SSC FC</option>
                <option>Kairat FC</option>
              </select>
            </label>
            <label>Player
              <select name="Player" required>
                <option value="">Selecione</option>
                <option>Sergio</option>
                <option>Fransua</option>
                <option>Jeromel</option>
                <option>Bruno Garducci</option>
                <option>Carlos</option>
                <option>Gigi</option>
                <option>Bruno Bortolo</option>
                <option>Alibek</option>
                <option>Ciro</option>
                <option>Love</option>
                <option>Nick</option>
                <option>Timur</option>
              </select>
            </label>
          </div>
          <div class="performance-groups">
            <div class="perf-row">
              <div class="perf-field">
                <label>Goals</label>
                <div class="input-group">
                  <button type="button" class="btn-minus" onclick="changeValue(this, -1)">−</button>
                  <input type="number" name="Goals" value="0" min="0"/>
                  <button type="button" class="btn-plus" onclick="changeValue(this, 1)">+</button>
                </div>
              </div>
              <div class="perf-field">
                <label>Assists</label>
                <div class="input-group">
                  <button type="button" class="btn-minus" onclick="changeValue(this, -1)">−</button>
                  <input type="number" name="Assists" value="0" min="0"/>
                  <button type="button" class="btn-plus" onclick="changeValue(this, 1)">+</button>
                </div>
              </div>
            </div>
            <div class="perf-row">
              <div class="perf-field">
                <label>Shots</label>
                <div class="input-group">
                  <button type="button" class="btn-minus" onclick="changeValue(this, -1)">−</button>
                  <input type="number" name="Shots" value="0" min="0"/>
                  <button type="button" class="btn-plus" onclick="changeValue(this, 1)">+</button>
                </div>
              </div>
              <div class="perf-field">
                <label>Interceptions</label>
                <div class="input-group">
                  <button type="button" class="btn-minus" onclick="changeValue(this, -1)">−</button>
                  <input type="number" name="Interceptions" value="0" min="0"/>
                  <button type="button" class="btn-plus" onclick="changeValue(this, 1)">+</button>
                </div>
              </div>
            </div>
            <div class="perf-row">
              <div class="perf-field">
                <label>Passes</label>
                <div class="input-group">
                  <button type="button" class="btn-minus" onclick="changeValue(this, -1)">−</button>
                  <input type="number" name="Passes" value="0" min="0"/>
                  <button type="button" class="btn-plus" onclick="changeValue(this, 1)">+</button>
                </div>
              </div>
              <div class="perf-field">
                <label>Card</label>
                <div class="card-visual-options">
                  <div class="card-select-wrap">
                    <input type="radio" name="Card" value="Yellow" id="card-yellow" />
                    <label for="card-yellow" class="card-visual yellow"></label>
                  </div>
                  <div class="card-select-wrap">
                    <input type="radio" name="Card" value="Red" id="card-red" />
                    <label for="card-red" class="card-visual red"></label>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <label>Image URL (Opcional)
            <input type="url" name="URL" placeholder="https://link_para_foto.do_jogador.jpg"/>
          </label>
          <button type="submit" class="submit-btn">Submit Player Performance</button>
          <div class="success-message">Player data submitted successfully!</div>
        </form>
      </div>
      <!-- Coluna da DIREITA: Tabela -->
      <div class="card">
        <h2 style="margin-bottom:.6rem;">Existing Player Performances</h2>
        <div class="muted">Source: player-performance (Google Sheets)</div>
        <div class="table-wrap" id="players-table">
          <table>
            <thead id="players-thead"></thead>
            <tbody id="players-tbody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- POWER BI DASHBOARD -->
  <div id="powerbi-dashboard" class="container form-section" style="display:none;">
    <div class="card powerbi-card">
      <iframe title="League Performance"
        src="https://app.powerbi.com/view?r=eyJrIjoiOTRjOGYxMWQtYzMxZC00YmYzLWEzN2ItYWU2ZGNjNmJlY2I2IiwidCI6ImM4MTYxZjNkLTIxMzQtNDVmMy1hZGU2LWYwNGIwNjY2ZDMwMiJ9"
        allowfullscreen="true"></iframe>
    </div>
  </div>

  <script>
    /* ENDPOINTS E TOKEN */
    const ENDPOINT_MATCHES = 'https://script.google.com/macros/s/AKfycbycaDGmtFqnj0FvBMDnx2Gs63QLpIc1MQLFvmk4Fq5LyngcbyQN0UzuaXsKEvBbREB6IQ/exec';
    const ENDPOINT_PLAYERS = 'https://script.google.com/macros/s/AKfycbyFt5lZTHN7eW3XqIparGjFBZ1P6HtV41JsOrJMfu-695oky3dLOs0hpJN_CUALyMtN/exec';
    const TOKEN = 'SEU_TOKEN_FORTE_AQUI'; // igual ao Apps Script

    // colunas que NÃO devem aparecer na TABELA de players
    const EXCLUDE_PLAYERS = ['Position', 'URL'];

    function switchTab(tabId, ev){
      document.querySelectorAll('.form-section').forEach(s => s.style.display = 'none');
      document.getElementById(tabId).style.display = 'block';
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      if (ev && ev.target) ev.target.classList.add('active');

      if (tabId === 'match-results') loadMatches();
      if (tabId === 'player-performance') loadPlayers();
    }

    // envia como x-www-form-urlencoded para evitar preflight
    async function submitForm(event, formType){
      event.preventDefault();
      const form = event.target;
      const data = Object.fromEntries(new FormData(form).entries());

      const url = (formType === 'match-results') ? ENDPOINT_MATCHES : ENDPOINT_PLAYERS;
      if (!url){ alert('Endpoint não configurado.'); return false; }

      const body = new URLSearchParams({ ...data, action:'add', token: TOKEN });

      try {
        const resp = await fetch(url, { method:'POST', body });
        const j = await resp.json();
        if (!j.ok) throw new Error(j.error || 'Falha ao enviar');

        const success = form.querySelector('.success-message');
        if (success){ success.style.display='block'; setTimeout(()=> success.style.display='none', 3500); }

        form.reset();
        if (formType === 'player-performance'){
          document.getElementById('team').value = 'Kairat Sydney FC';
          document.getElementById('goals').value = '0';
          loadPlayers();
        } else {
          document.getElementById('homeTeam').value = 'Kairat Sydney FC';
          const today = new Date().toISOString().split('T')[0];
          document.getElementById('date').value = today;
          loadMatches();
        }
      } catch (err){
        alert('Falhou: ' + err.message);
      }
      return false;
    }

    async function loadMatches(){
      await loadAndRender(
        ENDPOINT_MATCHES,
        'matches-thead',
        'matches-tbody',
        ['Date','Round','Home Team','Away Team','Home Goals','Away Goals','Registration Date'],
        [], true
      );
    }

    async function loadPlayers(){
      await loadAndRender(
        ENDPOINT_PLAYERS,
        'players-thead',
        'players-tbody',
        ['Round','Team','Player','Goals','Assists','Shots','Passes','Interceptions','Yellow Cards','Red Cards','Registration Date'],
        EXCLUDE_PLAYERS, true
      );
    }

    async function loadAndRender(endpoint, theadId, tbodyId, preferredOrder, excludeCols = [], withDelete = false){
      try {
        const resp = await fetch(endpoint, { method:'GET' });
        const json = await resp.json();
        if (!json.ok) throw new Error(json.error || 'Formato inválido');

        const thead = document.getElementById(theadId);
        const tbody = document.getElementById(tbodyId);
        thead.innerHTML = ''; tbody.innerHTML = '';

        const headers = reorderAndFilterHeaders(json.headers, preferredOrder, excludeCols);
        thead.innerHTML = `<tr>${headers.map(h=>`<th>${escapeHtml(h)}</th>`).join('')}${withDelete?'<th>Actions</th>':''}</tr>`;

        json.records.forEach(rec => {
          const tds = headers.map(h => {
            const v = rec[h];
            const cls = isNumeric(v) ? ' class="num"' : '';
            return `<td${cls}>${escapeHtml(formatCell(v))}</td>`;
          }).join('');
          const actions = withDelete ? `<td><button class="btn-del" onclick="deleteRow('${endpoint}', ${rec.rowNumber}, this)">Delete</button></td>` : '';
          tbody.insertAdjacentHTML('beforeend', `<tr>${tds}${actions}</tr>`);
        });
      } catch (e){
        console.error('[loadAndRender]', e);
        document.getElementById(tbodyId).innerHTML = `<tr><td>Failed to load data</td></tr>`;
      }
    }

    async function deleteRow(endpoint, rowNumber, btnEl){
      const ok = confirm(`Apagar a linha ${rowNumber}?`);
      if (!ok) return;
      try {
        const body = new URLSearchParams({ action:'delete', row:String(rowNumber), token:TOKEN });
        const resp = await fetch(endpoint, { method:'POST', body });
        const j = await resp.json();
        if (!j.ok) throw new Error(j.error || 'Falha ao deletar');
        btnEl.closest('tr').remove();
      } catch (err){
        alert('Erro ao deletar: ' + err.message);
      }
    }

    function reorderAndFilterHeaders(headers, preferred, exclude){
      const excludeSet = new Set((exclude||[]).map(x=>String(x).toLowerCase()));
      const norm = s => String(s||'').toLowerCase();
      const first = preferred.filter(h=>headers.includes(h)).filter(h=>!excludeSet.has(norm(h)));
      const rest  = headers.filter(h=>!preferred.includes(h)).filter(h=>!excludeSet.has(norm(h)));
      return [...first, ...rest];
    }
    function isNumeric(v){ return v!=='' && !isNaN(v) && !(Object.prototype.toString.call(v)==='[object Date]'); }
    function formatCell(v){
      if (v===null||v===undefined) return '';
      if (isNumeric(v)) return String(v);
      if (typeof v==='string' && !isNaN(Date.parse(v))){
        const d = new Date(v);
        if (!isNaN(d.getTime())) return fmtDate(d);
      }
      return String(v);
    }
    function fmtDate(d){
      const yyyy=d.getFullYear(),mm=String(d.getMonth()+1).padStart(2,'0'),dd=String(d.getDate()).padStart(2,'0');
      const hh=String(d.getHours()).padStart(2,'0'),mi=String(d.getMinutes()).padStart(2,'0');
      return `${dd}-${mm}-${yyyy} ${hh}:${mi}`;
    }
    function escapeHtml(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'","&#039;"); }

    document.addEventListener('DOMContentLoaded', () => {
      const today=new Date().toISOString().split('T')[0];
      const dateEl=document.getElementById('date'); if(dateEl) dateEl.value=today;
      loadMatches();
    });
  </script>
</body>
</html>
